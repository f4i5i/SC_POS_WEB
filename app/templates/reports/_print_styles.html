{# Reusable Print Styles for Reports #}
<style>
/* Print Header - Hidden on screen */
.print-header {
    display: none;
}

.print-footer {
    display: none;
}

.print-summary {
    display: none;
}

.signature-area {
    display: none;
}

/* Print Styles */
@media print {
    /* Hide screen-only elements */
    .sidebar, .navbar, .no-print, .btn, .btn-group,
    form:not(.print-form), .dropdown, .modal, .toast-container,
    .period-selector, .date-filter, .filter-section,
    canvas, .chart-container, .profit-health-indicator {
        display: none !important;
    }

    /* Reset page */
    body {
        background: white !important;
        font-size: 10pt;
        color: #000 !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }

    .main-content {
        margin-left: 0 !important;
        padding: 0 !important;
        width: 100% !important;
    }

    .container-fluid {
        padding: 0 !important;
        max-width: 100% !important;
    }

    /* Show print elements */
    .print-header {
        display: block !important;
        text-align: center;
        border-bottom: 3px double #000;
        padding-bottom: 15px;
        margin-bottom: 20px;
    }

    .print-header .business-name {
        font-size: 22pt;
        font-weight: bold;
        margin-bottom: 5px;
        letter-spacing: 1px;
    }

    .print-header .business-tagline {
        font-size: 10pt;
        color: #666;
        margin-bottom: 10px;
    }

    .print-header .report-title {
        font-size: 14pt;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 2px;
        margin-bottom: 5px;
        padding: 5px 0;
        border-top: 1px solid #ccc;
        border-bottom: 1px solid #ccc;
    }

    .print-header .report-period {
        font-size: 11pt;
        color: #333;
        margin-top: 10px;
    }

    .print-header .report-meta {
        font-size: 9pt;
        color: #666;
        margin-top: 5px;
    }

    .print-footer {
        display: block !important;
        margin-top: 30px;
        padding-top: 10px;
        border-top: 1px solid #ccc;
        font-size: 8pt;
        color: #666;
        text-align: center;
    }

    .print-summary {
        display: block !important;
        margin-bottom: 20px;
    }

    /* Hide regular header */
    .page-header-regular {
        display: none !important;
    }

    /* Cards styling for print */
    .card {
        border: 1px solid #ccc !important;
        box-shadow: none !important;
        break-inside: avoid;
        page-break-inside: avoid;
        margin-bottom: 15px !important;
    }

    .card-header {
        background: #f0f0f0 !important;
        border-bottom: 1px solid #ccc !important;
        padding: 8px 12px !important;
        font-weight: 600;
    }

    .card-body {
        padding: 10px 12px !important;
    }

    /* Table styling for print */
    .table {
        width: 100% !important;
        border-collapse: collapse !important;
        font-size: 9pt;
    }

    .table th {
        background: #e9ecef !important;
        border: 1px solid #ccc !important;
        padding: 6px 8px !important;
        font-weight: 600;
        text-align: left;
    }

    .table td {
        border: 1px solid #ccc !important;
        padding: 5px 8px !important;
    }

    .table-striped tbody tr:nth-of-type(odd) {
        background: #f9f9f9 !important;
    }

    .table-hover tbody tr:hover {
        background: none !important;
    }

    /* Report table specific */
    .report-table {
        width: 100%;
        border-collapse: collapse;
    }

    .report-table .section-header {
        background: #e0e0e0 !important;
        font-weight: bold;
        text-transform: uppercase;
        font-size: 9pt;
    }

    .report-table .total-row {
        background: #d4edda !important;
        font-weight: bold;
    }

    .report-table .total-row.negative {
        background: #f8d7da !important;
    }

    /* Summary boxes for print */
    .print-summary-box {
        display: inline-block;
        width: 18%;
        border: 1px solid #000;
        padding: 8px;
        text-align: center;
        margin: 0 1%;
        vertical-align: top;
    }

    .print-summary-box .label {
        font-size: 8pt;
        color: #666;
        text-transform: uppercase;
    }

    .print-summary-box .value {
        font-size: 12pt;
        font-weight: bold;
        margin: 5px 0;
    }

    .print-summary-box.highlight {
        background: #f0f0f0;
    }

    .print-summary-box.profit {
        background: #d4edda;
    }

    .print-summary-box.loss {
        background: #f8d7da;
    }

    /* Colors for print */
    .text-success { color: #198754 !important; }
    .text-danger { color: #dc3545 !important; }
    .text-primary { color: #0d6efd !important; }
    .text-warning { color: #856404 !important; }
    .text-info { color: #0dcaf0 !important; }
    .text-muted { color: #666 !important; }

    /* Layout adjustments */
    .row {
        display: block !important;
    }

    .col-md-6, .col-lg-6 {
        width: 49% !important;
        display: inline-block !important;
        vertical-align: top;
    }

    .col-md-4, .col-lg-4 {
        width: 32% !important;
        display: inline-block !important;
        vertical-align: top;
    }

    .col-md-8, .col-lg-8 {
        width: 100% !important;
    }

    .col-12 {
        width: 100% !important;
    }

    /* Hide sidebar column on print */
    .print-hide-sidebar {
        display: none !important;
    }

    /* Page breaks */
    .page-break-before { page-break-before: always; }
    .page-break-after { page-break-after: always; }
    .avoid-break { page-break-inside: avoid; }

    /* Badge styling for print */
    .badge {
        border: 1px solid #000 !important;
        color: #000 !important;
        background: #fff !important;
        padding: 2px 6px !important;
        font-size: 8pt !important;
    }

    /* Signature area */
    .signature-area {
        display: flex !important;
        justify-content: space-between;
        margin-top: 40px;
        padding-top: 20px;
    }

    .signature-box {
        width: 180px;
        text-align: center;
    }

    .signature-line {
        border-top: 1px solid #000;
        margin-top: 40px;
        padding-top: 5px;
        font-size: 9pt;
    }

    /* Stat cards for print */
    .stat-card, .summary-card {
        border: 1px solid #ccc !important;
        padding: 8px !important;
        text-align: center;
        box-shadow: none !important;
    }

    .stat-card .icon,
    .stat-card i.fa-3x,
    .stat-card i.fa-4x {
        display: none !important;
    }

    .stat-card .value,
    .stat-card h3 {
        font-size: 12pt !important;
        color: #000 !important;
    }

    /* Page setup */
    @page {
        margin: 1.5cm;
        size: A4;
    }

    @page :first {
        margin-top: 1cm;
    }
}
</style>

{# Print Header Macro #}
{% macro print_header(title, period='', location=None) %}
<div class="print-header">
    <div class="business-name">{{ business_name or 'Sunnat Collection' }}</div>
    <div class="business-tagline">Premium Attars & Perfumes</div>
    <div class="report-title">{{ title }}</div>
    {% if period %}
    <div class="report-period">{{ period }}</div>
    {% endif %}
    {% if location %}
    <div class="report-meta">Location: {{ location.name }}</div>
    {% endif %}
    <div class="report-meta">Generated: {{ now().strftime('%B %d, %Y at %I:%M %p') if now else '' }}</div>
</div>
{% endmacro %}

{# Print Footer Macro #}
{% macro print_footer() %}
<div class="print-footer">
    <p style="margin: 0;">This is a computer-generated document. No signature required.</p>
    <p style="margin: 5px 0 0 0; font-size: 7pt;">{{ business_name or 'Sunnat Collection' }} - Confidential</p>
</div>
{% endmacro %}

{# Signature Area Macro #}
{% macro signature_area() %}
<div class="signature-area">
    <div class="signature-box">
        <div class="signature-line">Prepared By</div>
    </div>
    <div class="signature-box">
        <div class="signature-line">Reviewed By</div>
    </div>
    <div class="signature-box">
        <div class="signature-line">Approved By</div>
    </div>
</div>
{% endmacro %}
